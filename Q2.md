# Q2 全情况统一口径：事件驱动 replay（Method）

> 关键主张：Q2 不能只看“标准单淘汰周”。因为要把两种合票方法应用到每一季，并比较整季淘汰路径与最终名次/冠军，所以 replay 必须纳入：退赛、无淘汰、双淘汰/多淘汰、决赛多淘汰，以及（可选）Judges’ Save。

## 0) 批判性提醒：外生事件不属于投票规则
并不是所有“离开比赛”的事件都由投票规则决定（例如退赛、某些无淘汰周），因此需要一个统一口径：

- **整季 replay**：包含所有事件（为了得到完整名次）
- **规则偏好（favor fan / favor judge）的统计**：主结论只在“投票确实产生淘汰动作”的周上做；退赛/无淘汰周只做描述或鲁棒性补充

---

## 1) Season-Week 事件类型分类（Event Types）

对每个 (season, week) 至少分成 5 类：

1. **standard_single_elim**：当周投票导致淘汰 1 人  
2. **multi_elim (k ≥ 2)**：当周投票导致淘汰 k 人（同周双淘汰/多淘汰）  
3. **no_elim**：当周无人淘汰（投票不产生淘汰动作）  
4. **withdrew_only**：当周有人退赛，但不发生投票淘汰  
5. **elim_plus_withdrew**：既有退赛又有投票淘汰（淘汰人数通常仍 ≥ 1）

> 写进论文的批判性句子：退赛属于外生事件，不归因于投票规则，否则“规则更偏粉丝/评委”的结论会被污染。

---

## 2) 统一 replay 框架：维护 active roster

从 Week 1 到最后一周，维护一个仍在比赛的集合 `A`（active roster）。

### 2.1 先处理退赛 withdrew（外生退出）
- 若当周有 withdrew 名单 `W`：  
  `A ← A \ W`

> 建议：withdraw 先于淘汰。理由：退赛者不应参与当周 bottom2 / 排名计算，否则会扭曲淘汰结果。

### 2.2 no_elim 周
- 不执行任何投票淘汰动作：  
  `A` 不变（直接进入下一周）

> 允许记录该周“风险分数/底部候选”用于分析，但不能把它当真实淘汰动作。

### 2.3 standard_single_elim 周（k=1）
对三种规则分别定义“淘汰函数”：

- **percent**：合分 `C = judge_share + fan_share`，淘汰合分最低者  
- **rank**：总排名 `R = judge_rank + fan_rank`，淘汰总排名最高者  
- **bottom2 + judges save**（两阶段）：
  1) 用 percent/rank 先确定 bottom2  
  2) 在 bottom2 中，由评委选择淘汰者（最简：淘汰 judge 更差者；也可 soft）

---

## 3) multi_elim 周：同周淘汰 k 人怎么实现？

### 方案 A（推荐）：逐个淘汰（sequential, without replacement）
循环 k 次：
1. 用当前 active roster 计算规则分数
2. 淘汰 1 人
3. 更新 active roster 后重新计算下一次淘汰

**关键细节：**
- 对 **percent**：每淘汰 1 人后，必须在剩余 active 内对 fan_share 重新归一化  
  （否则等价于“暗中缩小粉丝权重”，偏向评委）
- 对 **rank**：每次淘汰后要在剩余人中重算排名（rank 是相对次序）

> 批判性说明：这把“同周同时淘汰”近似成顺序过程。优点是可实现、可解释；缺点是忽略同时发生细节，但对宏观比较足够。

### 方案 B：一次性选出 k 个淘汰者（simultaneous top-k）
- percent：取合分最低的 k 个（或概率无放回抽样）
- rank：取总排名最高的 k 个
- bottom2+save 通常仍更适合方案 A（因为 bottom2 与 save 是逐次决策）

---

## 4) 决赛/半决赛（最后一周淘汰到冠军）
把它当作 multi_elim：`k = |A| - 1`  
按规则逐个淘汰，直到剩 1 人为冠军。

---

## 5) 平局 tie 的处理（必须定义）
推荐 tie-break（确定且可复现）：
- 优先淘汰 judge 更低者
- 若仍平局：固定随机种子后随机选择

> 批判性点：tie-break 影响个别周但不应主导整体结论，可做一次敏感性分析说明其影响小。

---

## 6) “偏向粉丝”如何量化（避免特殊周污染）
- **整季 replay**：用于比较冠军/最终名次差异（包含全部事件）
- **favor fan 统计**：只在“投票产生淘汰动作”的周上计算主指标；withdraw/no_elim 周只做描述

可选指标：
- **Fan-alignment**：最终名次与平均 fan_share 的 Spearman 相关（越高越偏粉丝）
- **Fan-rescue rate**：judge 很差但 fan 很强的人，在该规则下存活/进阶概率（越高越偏粉丝）
