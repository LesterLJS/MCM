ğŸ‘ OKKï¼Œé‚£æˆ‘å°±æŠŠä½ ç°åœ¨ `/mnt/data/model_df.csv` é‡Œ**æ¯ä¸ªè¡¨å¤´ï¼ˆå…± 24 åˆ—ï¼‰**å†™æˆä¸€ä»½ã€Œ**å¯ç›´æ¥ç²˜è¿›è®ºæ–‡/æŠ¥å‘Š**ã€çš„**å˜é‡å®šä¹‰è¡¨**ï¼ˆå«è®¡ç®—å…¬å¼/æ¥æºï¼‰ï¼Œå†é¡ºæ‰‹æŠŠæˆ‘åŸºäºä½ çœŸå®æ–‡ä»¶åšçš„**å¿«é€Ÿä¸€è‡´æ€§æ£€æŸ¥ç»“æœ**å’Œ **Q1 ä¸‰å¥—â€œå¹²å‡€æ ·æœ¬â€CSV** ä¸€èµ·ç»™ä½ ã€‚

---

## 1) å…ˆå¯¹ä½ çœŸå®çš„ `model_df.csv` åšä¸ªå¿«é€Ÿæ ¸å¯¹ï¼ˆé¿å…è®ºæ–‡å†™é”™æ•°å­—ï¼‰

ä½ ä¸Šä¼ çš„ `model_df.csv` å®é™…æ˜¯ï¼š

* `shape = 4199 Ã— 24`
* `season = 1..34`ï¼ˆ34å­£ï¼‰
* `week = 1..11`
* `week_exists` åœ¨è¯¥æ–‡ä»¶é‡Œ **å…¨éƒ¨ä¸º True**ï¼ˆè¯´æ˜ä½ å·²å‰”é™¤ä¸å­˜åœ¨å‘¨ âœ…ï¼‰
* `Withdrew` é€‰æ‰‹æ•° = **10**
* èµ›åˆ¶æ ‡ç­¾åˆ†å¸ƒï¼ˆæŒ‰ä½  scheme è§„åˆ™ï¼‰ï¼š

  * `percent`ï¼ˆS3â€“S27ï¼‰= 3051 è¡Œ
  * `rank`ï¼ˆS1â€“S2ï¼‰= 116 è¡Œ
  * `rank_bottom2`ï¼ˆS28â€“S34ï¼‰= 1032 è¡Œ
* æŒ‰â€œèµ›å­£-å‘¨â€ç»Ÿè®¡çš„æ·˜æ±°äººæ•° `elim_n` åˆ†å¸ƒï¼š

  * `elim_n=0`ï¼š71 ä¸ª season-week
  * `elim_n=1`ï¼š231 ä¸ª season-weekï¼ˆQ1 æœ€å¹²å‡€çš„ä¸»æ ·æœ¬ï¼‰
  * `elim_n=2`ï¼š32 ä¸ª season-week
  * `elim_n=3`ï¼š1 ä¸ª season-week

---

## 2) è®ºæ–‡å¯ç”¨ï¼š`model_df` å˜é‡å®šä¹‰è¡¨ï¼ˆæ¯ä¸ªè¡¨å¤´æ€ä¹ˆè®¡ç®—ï¼‰

### A. ä¸»é”®ä¸é™æ€å±æ€§ï¼ˆç›´æ¥æ¥è‡ªåŸå§‹è¡¨/merge å›æ¥ï¼‰

| å­—æ®µ                             | ç±»å‹        | å®šä¹‰/æ¥æº                                 |
| ------------------------------ | --------- | ------------------------------------- |
| `season`                       | int       | èµ›å­£ç¼–å·ï¼ˆåŸå§‹åˆ—ï¼‰                             |
| `week`                         | int       | ä»åˆ—å `week{w}_judge{j}_score` è§£æå¾—åˆ°çš„å‘¨ç¼–å· |
| `celebrity_name`               | str       | é€‰æ‰‹å§“åï¼ˆåŸå§‹åˆ—ï¼‰                             |
| `ballroom_partner`             | str       | èˆä¼´ï¼ˆåŸå§‹åˆ—ï¼‰                               |
| `celebrity_industry`           | str       | è¡Œä¸šï¼ˆåŸå§‹åˆ—ï¼‰                               |
| `celebrity_homestate`          | str       | å®¶ä¹¡å·/åœ°åŒºï¼ˆåŸå§‹åˆ—ï¼‰                           |
| `celebrity_homecountry/region` | str       | å›½å®¶/åœ°åŒºï¼ˆåŸå§‹åˆ—ï¼‰                            |
| `celebrity_age_during_season`  | float/int | è¯¥å­£å¹´é¾„ï¼ˆåŸå§‹åˆ—ï¼‰                             |
| `results`                      | str       | æ–‡æœ¬ç»“æœå­—æ®µï¼ˆåŸå§‹åˆ—ï¼Œå« Eliminated/Withdrew ç­‰ï¼‰   |
| `placement`                    | float/int | æœ€ç»ˆåæ¬¡ï¼ˆåŸå§‹åˆ—ï¼‰                             |

> æ³¨ï¼šè¿™äº›å­—æ®µä¼šåœ¨åŒä¸€é€‰æ‰‹åŒä¸€èµ›å­£çš„æ¯ä¸€å‘¨é‡å¤å‡ºç°ï¼Œè¿™æ˜¯é¢æ¿æ•°æ®ç»“æ„çš„æ­£å¸¸ç»“æœã€‚

---

### B. å‘¨è¯„åˆ†èšåˆï¼ˆç”± long è¡¨ groupby å¾—åˆ°ï¼‰

ä»¤è¯¥è¡Œå¯¹åº”é€‰æ‰‹ (i)ã€èµ›å­£ (s)ã€å‘¨ (w)ï¼Œè¯¥å‘¨å¯ç”¨è¯„å§”é›†åˆä¸º (J_{s,w,i})ï¼Œå•è¯„å§”åˆ†æ•°ä¸º (x_{s,w,i,j})ã€‚

| å­—æ®µ            | å®šä¹‰ï¼ˆè®¡ç®—æ–¹å¼ï¼‰                                    | ä½œç”¨                    |                                             |                 |
| ------------- | ------------------------------------------- | --------------------- | ------------------------------------------- | --------------- |
| `judge_count` | (\sum_{j} \mathbf{1}(x_{s,w,i,j}\neq NaN))  | å½“å‘¨è¯¥é€‰æ‰‹å®é™…æœ‰å‡ ä½è¯„å§”è¯„åˆ†ï¼ˆ2/3/4ï¼‰ |                                             |                 |
| `judge_total` | (\sum_{j\in J_{s,w,i}} x_{s,w,i,j})ï¼ˆå¿½ç•¥ NaNï¼‰ | å½“å‘¨è¯„å§”æ€»åˆ†ï¼ˆæ·˜æ±°åé€šå¸¸è®° 0ï¼‰      |                                             |                 |
| `judge_mean`  | (\frac{1}{                                  | J_{s,w,i}             | }\sum_{j\in J_{s,w,i}} x_{s,w,i,j})ï¼ˆå¿½ç•¥ NaNï¼‰ | å½“å‘¨è¯„å§”å‡åˆ†ï¼ˆæ›´åˆ©äºè·¨å‘¨æ¯”è¾ƒï¼‰ |

---

### C. ç»“æ„æ­£ç¡®æ€§å­—æ®µï¼ˆè§£å†³â€œä¸å­˜åœ¨å‘¨è¢«å½“ 0 åˆ†â€çš„å‘ï¼‰

| å­—æ®µ            | å®šä¹‰ï¼ˆè®¡ç®—æ–¹å¼ï¼‰                                    | ä½œç”¨                              |
| ------------- | ------------------------------------------- | ------------------------------- |
| `week_exists` | å¯¹å›ºå®š (s,w)ï¼šåªè¦è¯¥å­£è¯¥å‘¨ **ä»»æ„é€‰æ‰‹ä»»æ„è¯„å§”åˆ†æ•°é NaN** â†’ True | é˜²æ­¢â€œæ•´å‘¨ä¸å­˜åœ¨ä½†è¢«è¯¯å½“ä½œ 0 åˆ†/æ·˜æ±°åå¾— 0â€       |
| `active`      | `judge_total > 0`                           | åˆ¤æ–­å½“å‘¨æ˜¯å¦ä»åœ¨æ¯”èµ›ï¼ˆåç»­å‘¨å†…æ ‡å‡†åŒ–åªå¯¹ active è®¡ç®—ï¼‰ |

---

### D. å‘¨å†…æ ‡å‡†åŒ–ï¼ˆèµ›åˆ¶å…¼å®¹ï¼špercent / rankï¼‰

ä»¤å½“å‘¨ä»åœ¨æ¯”èµ›çš„é€‰æ‰‹é›†åˆä¸º (A_{s,w})ã€‚

| å­—æ®µ            | å®šä¹‰ï¼ˆè®¡ç®—æ–¹å¼ï¼‰                                                                 | ä½œç”¨                                  |
| ------------- | ------------------------------------------------------------------------ | ----------------------------------- |
| `judge_share` | (\frac{judge_total_i}{\sum_{k\in A_{s,w}} judge_total_k})ï¼ˆä»…åœ¨ active å†…è®¡ç®—ï¼‰ | percent èµ›åˆ¶ç”¨ï¼šå‘¨å†…å½’ä¸€åŒ–ï¼Œå‰Šå¼±è¯„å§”äººæ•°å·®å¼‚/bonus å½±å“ |
| `judge_rank`  | åœ¨ (A_{s,w}) å†…æŒ‰ `judge_total` é™åºæ’åï¼ˆæœ€å¥½=1ï¼‰ï¼Œå¹¶åˆ—ç”¨ `min`                        | rank èµ›åˆ¶ç”¨ï¼šåªç”¨ç›¸å¯¹é¡ºåºï¼Œä¸ä¾èµ–åˆ†å·®               |

---

### E. æ·˜æ±°ä¸é€€èµ›äº‹ä»¶å­—æ®µï¼ˆä» results è§£æ + è®¡æ•°/æ¨æ–­ï¼‰

| å­—æ®µ                          | å®šä¹‰ï¼ˆè®¡ç®—æ–¹å¼ï¼‰                                                           | ä½œç”¨                            |
| --------------------------- | ------------------------------------------------------------------ | ----------------------------- |
| `is_withdrew_season`        | `results` æ˜¯å¦åŒ…å« â€œWithdrewâ€ï¼ˆcase-insensitiveï¼‰                        | è¯¥é€‰æ‰‹è¯¥å­£æ˜¯å¦é€€èµ›ï¼ˆé€€èµ›â‰ æŠ•ç¥¨æ·˜æ±°ï¼‰            |
| `is_eliminated_this_week`   | è¯¥ (season, week, celebrity) æ˜¯å¦åŒ¹é… â€œEliminated Week Xâ€ï¼ˆä¸”æ’é™¤ Withdrewï¼‰ | æ˜¯å¦åœ¨è¯¥å‘¨è¢«æŠ•ç¥¨æ·˜æ±°ï¼ˆç”¨äºæ„é€  Q1 çº¦æŸï¼‰        |
| `elim_n`                    | æ¯ä¸ª (season, week) ä¸Š `is_eliminated_this_week=True` çš„ä¸åŒé€‰æ‰‹æ•°          | å½“å‘¨æ·˜æ±°äººæ•°ï¼ˆ0/1/2/3â€¦ï¼ŒQ1 ä¸»æ¨¡å‹ä¸€èˆ¬å…ˆç”¨ 1ï¼‰ |
| `withdrew_last_active_week` | è¯¥é€‰æ‰‹è¯¥å­£æ»¡è¶³ `judge_total>0` çš„æœ€å¤§å‘¨                                       | æœ€åä¸€æ¬¡ä»åœ¨åœºçš„å‘¨                     |
| `withdrew_event_week`       | ä»ç¬¬ä¸€æ¬¡æœ‰åˆ†å‘¨èµ·ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ª `judge_total==0` çš„å­˜åœ¨å‘¨                               | æ¨æ–­é€€èµ›ç”Ÿæ•ˆå‘¨ï¼ˆä¾¿äºå‰”é™¤â€œé€€èµ›å†²å‡»å‘¨â€ï¼‰          |

---

### F. å‘¨çº§å¼ºåº¦æŒ‡æ ‡ä¸èµ›åˆ¶æ ‡ç­¾

| å­—æ®µ         | å®šä¹‰ï¼ˆè®¡ç®—æ–¹å¼ï¼‰                                             | ä½œç”¨                  |
| ---------- | ---------------------------------------------------- | ------------------- |
| `n_active` | æ¯ä¸ª (season, week) å†… `active=True` çš„ä¸åŒé€‰æ‰‹æ•°             | å½“å‘¨åœ¨åœºäººæ•°ï¼ˆçº¦æŸå¼ºåº¦/ç¨³å®šæ€§ï¼‰    |
| `scheme`   | `season<=2: rank; 3â€“27: percent; >=28: rank_bottom2` | èµ›åˆ¶åˆ†æ®µæ ‡ç­¾ï¼ˆQ1/Q2 åˆ†æ®µåˆ†æç”¨ï¼‰ |

---

## 3) æˆ‘å·²ç»æ›¿ä½ æŠŠ Q1 çš„â€œä¸‰å¥—å¹²å‡€æ ·æœ¬â€å¯¼å‡ºäº†ï¼ˆç›´æ¥ä¸‹è½½ï¼‰

æˆ‘æŒ‰ä½ ä¹‹å‰çš„æ¨èè§„åˆ™åšäº†ç­›é€‰ï¼ˆ**scheme å¯¹åº”èµ›æ®µ + `elim_n==1` + å‰”é™¤é€€èµ›å†²å‡»å‘¨ + ä»…ä¿ç•™ active + `n_active>=3`**ï¼‰ï¼Œåˆ†åˆ«ç”Ÿæˆäº†ï¼š

* **percent ä¸»æ ·æœ¬ï¼ˆS3â€“S27ï¼‰**ï¼š`q1_percent_clean.csv`ï¼ˆ1383 è¡Œï¼‰
* **rank æ ·æœ¬ï¼ˆS1â€“S2ï¼‰**ï¼š`q1_rank_clean.csv`ï¼ˆ64 è¡Œï¼‰
* **rank_bottom2 æ ·æœ¬ï¼ˆS28â€“S34ï¼‰**ï¼š`q1_rank_bottom2_clean.csv`ï¼ˆ460 è¡Œï¼‰

ä¸‹è½½é“¾æ¥åœ¨è¿™ï¼š

* [Download q1_percent_clean.csv](sandbox:/mnt/data/q1_percent_clean.csv)
* [Download q1_rank_clean.csv](sandbox:/mnt/data/q1_rank_clean.csv)
* [Download q1_rank_bottom2_clean.csv](sandbox:/mnt/data/q1_rank_bottom2_clean.csv)

---

å¦‚æœä½ ç°åœ¨è¦æ­£å¼â€œè¿›å…¥ Q1â€ï¼Œä½ åªè¦å‘Šè¯‰æˆ‘ä½ æƒ³å…ˆè·‘å“ªä¸€ä¸ªèµ›æ®µï¼ˆä¸€èˆ¬å…ˆ `percent`ï¼‰ï¼Œæˆ‘å°±ç›´æ¥ç”¨è¿™ä¸ª clean æ–‡ä»¶ç»™ä½ æ¥ä¸Šï¼š**ï¼ˆ1ï¼‰æ„é€ æ·˜æ±°çº¦æŸ â†’ï¼ˆ2ï¼‰æœ€å¤§ç†µ/LP å€’æ¨æŠ•ç¥¨ä»½é¢ â†’ï¼ˆ3ï¼‰PPC/Hit/ç½®ä¿¡åŒºé—´** çš„æ•´å¥—ä»£ç ã€‚
